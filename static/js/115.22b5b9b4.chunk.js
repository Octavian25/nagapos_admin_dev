(window.webpackJsonp=window.webpackJsonp||[]).push([[115],{1306:function(a,t,e){"use strict";e.r(t);var i=e(19),n=e(20),l=e(33),s=e(22),o=e(21),r=e(0),c=e.n(r),d=e(58),u=e(28),p=e(64),m=e(312),g=e(65),b=e(36),h=e(123),f=e(13),_=e(311),v=e(78),S=e(9),O=e(211),k=e(210),E=e.n(k),j=function(a){Object(s.a)(e,a);var t=Object(o.a)(e);function e(a){var n;return Object(i.a)(this,e),(n=t.call(this,a)).state={isLoading:!1,DataValidasi:[],btnValidasi:!1,kode_sales:!1,warna:!1},n}return Object(n.a)(e,[{key:"componentDidMount",value:function(){this.props.dispatch(Object(S.Wb)()),0===this.props.saveValidasiJual.length&&0===this.props.saveValidasiBeli.length&&(localStorage.setItem("validasi_titipan",JSON.stringify([])),localStorage.setItem("validasi_beli",JSON.stringify([])))}},{key:"getDataSales",value:function(a){var t=this;localStorage.setItem("validasi_titipan",JSON.stringify([])),localStorage.setItem("validasi_beli",JSON.stringify([])),this.setState({kode_sales:a}),Object(f.d)("sales/get/by-kode-sales/"+a).then(function(a){t.props.change("nama_sales",a.data.nama_sales),t.props.dispatch(Object(g.l)([])),t.props.dispatch(Object(g.k)([]))}).catch(function(a){Object(b.e)("info","Gagal Mengambil Data Keserver")})}},{key:"getDetaValidasi",value:function(){var a=this,t={kode_sales:this.state.kode_sales};if(!1===t.kode_sales)return Object(b.e)("info","Kode Sales Harus Di pilih"),this.setState({isLoading:!1}),!1;this.setState({isLoading:!0}),"SEMUA"===this.state.kode_sales?Object(f.e)("titip/unvalid",t).then(function(t){if(0===t.data.length)Object(b.e)("info","Belum Ada Data Yang Harus Di Validasi"),a.setState({isLoading:!1}),a.props.change("grandtotal",0);else{var e=0;t.data.forEach(function(a){e+=a.harga_total}),a.props.change("grandtotal",e.toLocaleString("kr-KO")),Object(b.e)("success","Data Validasi Tersedia"),a.setState({isLoading:!1}),a.props.dispatch(Object(g.i)(!0)),localStorage.setItem("validasi_titipan",JSON.stringify(t.data)),a.props.dispatch(Object(g.l)(t.data))}}).catch(function(t){Object(b.e)("info","Terjadi Kesalahan Saat Request"),a.setState({isLoading:!1,DataValidasi:[]})}):Object(f.e)("titip/unvalid/by-sales/"+this.state.kode_sales).then(function(t){if(console.log(t),0===t.data.length)Object(b.e)("info","Belum Ada Data Yang Harus Di Validasi"),a.setState({isLoading:!1}),a.props.change("grandtotal",0);else{var e=0;t.data.forEach(function(a){e+=a.harga_total}),a.props.change("grandtotal",e.toLocaleString("kr-KO")),Object(b.e)("success","Data Validasi Tersedia"),a.setState({isLoading:!1}),a.props.dispatch(Object(g.i)(!0)),localStorage.setItem("validasi_titipan",JSON.stringify(t.data)),a.props.dispatch(Object(g.l)(t.data))}}).catch(function(t){Object(b.e)("info","Terjadi Kesalahan Saat Request"),a.setState({isLoading:!1,DataValidasi:[]})})}},{key:"render",value:function(){var a=this,t={mode:"checkbox",clickToSelect:!0,selectColumnPosition:"right",onSelect:function(a,t,e,i){if(!0===t){var n={no_titip_group:a.no_titip_group},l=JSON.parse(localStorage.getItem("data_validasi_titip"))||[];-1===l.findIndex(function(t){return t.no_titip_group===a.no_titip_group})&&(l.push(n),localStorage.setItem("data_validasi_titip",JSON.stringify(l)))}else if(null===localStorage.getItem("data_validasi_titip"));else{var s=JSON.parse(localStorage.getItem("data_validasi_titip"));s.splice(a.no_titip_group,1),localStorage.setItem("data_validasi_titip",JSON.stringify(s))}},onSelectAll:function(a,t,e){t.forEach(function(t,e){if(!0===a){var i={no_titip_group:t.no_titip_group},n=JSON.parse(localStorage.getItem("data_validasi_titip"))||[];-1===n.findIndex(function(a){return a.no_titip_group===t.no_titip_group})&&(n.push(i),localStorage.setItem("data_validasi_titip",JSON.stringify(n)))}else if(null===localStorage.getItem("data_validasi_titip"));else{var l=JSON.parse(localStorage.getItem("data_validasi_titip"));l.splice(t.no_titip_group,1),localStorage.setItem("data_validasi_titip",JSON.stringify(l))}})}},e=[{kode_sales:"SEMUA",nama_sales:"SEMUA"}];return this.props.DataSales.forEach(function(a){var t={kode_sales:a.kode_sales,nama_sales:a.nama_sales};e.push(t)}),c.a.createElement("form",{onSubmit:this.props.handleSubmit,autoComplete:"off",onKeyPress:function(a){"Enter"===a.key&&a.preventDefault()}},c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-3"},c.a.createElement(_.a,{name:"kode_sales",onChange:function(t){return a.getDataSales(t)},label:"Pilih Kode Sales",placeholder:"Masukan Kode Sales",options:e.map(function(a){return{value:a.kode_sales,name:a.nama_sales}}),component:v.f})),c.a.createElement("div",{className:"col-3"},c.a.createElement(_.a,{name:"nama_sales",component:v.e,type:"text",label:"Nama Sales",placeholder:"Masukan Nama Sales",readOnly:!0})),c.a.createElement("div",{className:"col-3"},c.a.createElement(_.a,{name:"grandtotal",component:v.e,type:"text",label:"Grand Total",placeholder:"Grand Total",readOnly:!0,customeCss:this.state.warna?"customeInput":""})),c.a.createElement("div",{className:"col-3"},c.a.createElement("label",null,"\xa0"),c.a.createElement("button",{onClick:function(){return a.getDetaValidasi()},className:"btn btn-primary btn-block",disabled:this.state.isLoading,type:"button"},this.state.isLoading?c.a.createElement(c.a.Fragment,null,c.a.createElement("i",{className:"fas fa-spinner fa-spin"})," \xa0 Cari Data"):"Cari Data")),c.a.createElement("div",{className:"col-12"},c.a.createElement(h.a,null,c.a.createElement(h.c,null,"List Data Titipan"),c.a.createElement("br",null),c.a.createElement(O.a,{selectRow:t,keyField:"kode_barcode",columns:this.props.columnsJual,data:this.props.saveValidasiJual||[],empty:!0}))),c.a.createElement("div",{className:"col-6"},!1===this.props.btnValidasi?c.a.createElement("button",{className:"btn btn-primary btn-block",disabled:!0,type:"button"},"Validasi"):c.a.createElement("button",{className:"btn btn-primary btn-block",disabled:this.props.isLoading,type:"submit"},this.props.isLoading?c.a.createElement(c.a.Fragment,null,c.a.createElement("i",{className:"fas fa-spinner fa-spin"})," \xa0 Validasi"):"Validasi")),c.a.createElement("div",{className:"col-6"},c.a.createElement("button",{className:"btn btn-warning btn-block",disabled:this.props.isLoadingBtl,onClick:this.props.btnClear,type:"button"},this.props.isLoadingBtl?c.a.createElement(c.a.Fragment,null,c.a.createElement("i",{className:"fas fa-spinner fa-spin"})," \xa0 Batal"):"Batal"))),this.props.isLoading?c.a.createElement(E.a,{loading:!0,background:"rgba(0, 0, 0, 0.35)",loaderColor:"rgba(94, 147, 117, 1)"}):null)}}]),e}(r.Component);j=Object(m.a)({form:"HeadValidasiTitipanHutang",enableReinitialize:!0})(j);var N=Object(d.b)(function(a){return{DataSales:a.datamaster.getDataSales,saveValidasiBeli:a.hutang.saveValidasiBeli,saveValidasiJual:a.hutang.saveValidasiJual,btnValidasi:a.hutang.disableButtonValidasi}})(j),y=function(a){Object(s.a)(e,a);var t=Object(o.a)(e);function e(a){var n;return Object(i.a)(this,e),(n=t.call(this,a)).state={isLoading:!1,isLoadingBtl:!1,columnsJual:[{dataField:"no_titip_group",text:"No Titip",footer:function(a,t,e,i){return c.a.createElement("div",null,"Total Barang :"," ",null===JSON.parse(localStorage.getItem("validasi_titipan"))?0:JSON.parse(localStorage.getItem("validasi_titipan")).length||0," ")}},{dataField:"kode_barcode",text:"Kode Barcode "},{dataField:"nama_barang",text:"Nama Barang",footer:"",footerAttrs:{colSpan:"3"}},{dataField:"nama_atribut",text:"Nama Atribut"},{dataField:"berat",text:"Berat",formatter:function(a){return a.toFixed(3)},footer:function(a){return a.reduce(function(a,t){return a+t},0).toFixed(3)}},{dataField:"harga_total",text:"Harga",headerClasses:"text-right",footer:function(a){return localStorage.setItem("total_harga_beli",a.reduce(function(a,t){return a+t},0)),c.a.createElement("div",{className:"text-right"}," ",a.reduce(function(a,t){return a+t},0).toLocaleString("kr-KO"))},formatter:function(a){return c.a.createElement("div",{className:"text-right"},parseFloat(a).toLocaleString("kr-KO"))}}]},n.handleSubmit=n.handleSubmit.bind(Object(l.a)(n)),n.btnClear=n.btnClear.bind(Object(l.a)(n)),n}return Object(n.a)(e,[{key:"btnClear",value:function(){var a=this;this.setState({isLoadingBtl:!0}),setTimeout(function(){localStorage.removeItem("validasi_titipan"),localStorage.removeItem("validasi_beli"),a.props.dispatch(Object(p.d)("HeadValidasiJualBeliHutang")),a.props.dispatch(Object(g.l)([])),a.props.dispatch(Object(g.k)([])),a.props.dispatch(Object(g.i)(!1)),a.setState({isLoadingBtl:!1})},1e3)}},{key:"componentWillUnmount",value:function(){this.props.dispatch(Object(g.l)([])),this.props.dispatch(Object(g.k)([]))}},{key:"handleSubmit",value:function(a){var t=this,e=JSON.parse(localStorage.getItem("data_validasi_titip"));Object(f.j)("validasi/simpan/jualbeli",e).then(function(a){if(0!==a.data.notabeli.length){var e="";a.data.notabeli.forEach(function(a,t){var i=a.head.n_alamat_customer.length;e+="========================================\nTanggal          : ".concat(a.head.tgl_system,"\nNama Customer    : ").concat(a.head.nama_customer,"\nNo Hp            : ").concat(a.head.no_hp,"\nAlamat Customer  : ").concat(a.head.n_alamat_customer.split(0,20),"\n"),i>20&&(e+="                   ".concat(a.head.n_alamat_customer.split(0,20),"\n")),i>40&&(e+="                   ".concat(a.head.n_alamat_customer.split(40,20),"\n")),e+="========================================\n",e+="Keterangan\n",e+="========================================\n";var n=0,l=0;a.detail.forEach(function(a,t){n+=a.harga,l+=a.harga_nota,e+="No Faktur Beli : ".concat(a.no_faktur_beli,"\n"),e+="Jenis Barang   : ".concat(a.kode_dept,"\n"),e+="Nama Barang    : ".concat(a.nama_barang,"\n"),e+="Berat          : ".concat(a.berat.toFixed(3),"\n"),e+="Harga          : ".concat(a.harga.toLocaleString("kr-KO"),"\n"),e+="========================================\n"}),e+="Total          : ".concat(n.toLocaleString("kr-KO"),"\n"),e+="========================================\n",e+="Harga Waktu Beli   : ".concat(n.toLocaleString("kr-KO"),"\n"),e+="Harga Waktu Jual   : ".concat(l.toLocaleString("kr-KO"),"\n"),e+="\n\n\n\n"}),document.getElementById("myInput").value=e,setTimeout(function(){t.TextFile()},100)}localStorage.removeItem("validasi_titipan"),localStorage.removeItem("validasi_beli"),t.props.dispatch(Object(p.d)("HeadValidasiJualBeliHutang")),t.props.dispatch(Object(g.l)([])),t.props.dispatch(Object(g.k)([])),Object(b.e)("success","Validasi Transaksi Berhasil"),t.props.dispatch(Object(g.i)(!1))}).catch(function(a){console.log(a.response.data),Object(b.e)("info","Terjadi Kesalahaan Saat Mengirim Data")})}},{key:"TextFile",value:function(){var a=document.createElement("a"),t=new Blob([document.getElementById("myInput").value],{type:"text/plain;charset=utf-8"});a.href=URL.createObjectURL(t),a.download="autoprint_pembelian.txt",document.body.appendChild(a),a.click()}},{key:"render",value:function(){var a=this;return c.a.createElement("div",null,c.a.createElement("ol",{className:"breadcrumb float-xl-right"},c.a.createElement("li",{className:"breadcrumb-item"},c.a.createElement(u.b,{to:"#"},"Kasir")),c.a.createElement("li",{className:"breadcrumb-item active"},"Validasi Titipan")),c.a.createElement("h1",{className:"page-header"},"Validasi Titipan "),c.a.createElement(h.a,null,c.a.createElement(h.c,null,"Validasi Titipan"),c.a.createElement("textarea",{style:{display:"none"},id:"myInput",rows:"100",cols:"100"}),c.a.createElement("br",null),c.a.createElement("div",{className:"container"},c.a.createElement(N,{onSubmit:function(t){return a.handleSubmit(t)},btnClear:function(){return a.btnClear()},isLoadingBtl:this.state.isLoadingBtl,columnsBeli:this.state.columnsBeli,columnsJual:this.state.columnsJual})),c.a.createElement("br",null)))}}]),e}(c.a.Component);y=Object(m.a)({form:"FormValidasiTitipan",enableReinitialize:!0})(y);t.default=Object(d.b)()(y)}}]);
//# sourceMappingURL=115.22b5b9b4.chunk.js.map