(window.webpackJsonp=window.webpackJsonp||[]).push([[58],{1262:function(a,e,t){"use strict";t.r(e);var n=t(19),r=t(20),l=t(33),i=t(22),s=t(21),o=t(12),c=t(13),m=t(210),u=t.n(m),b=function(a){Object(i.a)(t,a);var e=Object(s.a)(t);function t(a){var r;return Object(n.a)(this,t),(r=e.call(this,a)).state={date:new Date},r.setStartDate=r.setStartDate.bind(Object(l.a)(r)),r.setLastDate=r.setLastDate.bind(Object(l.a)(r)),r}return Object(r.a)(t,[{key:"handleSubmit",value:function(a){}},{key:"setStartDate",value:function(a){this.setState({tgl_awal:new Date(a)})}},{key:"setLastDate",value:function(a){this.setState({tgl_akhir:new Date(a)})}},{key:"render",value:function(){var a=this;return o.n.createElement("div",null,o.n.createElement("form",{onSubmit:this.props.handleSubmit,onKeyPress:function(a){"Enter"===a.key&&a.preventDefault()},autoComplete:"off"},o.n.createElement("div",{className:"row"},o.n.createElement("div",{className:"col-lg-4"},o.n.createElement(o.c,{name:"tgl_awal",component:o.f,label:"Tanggal Dari",type:"text",selected:this.state.tgl_awal,onChange:function(e){return a.setStartDate(e)},placeholder:"Masukan Tanggal Dari"})),o.n.createElement("div",{className:"col-lg-4"},o.n.createElement(o.c,{name:"tgl_akhir",component:o.f,type:"text",selected:this.state.tgl_akhir,onChange:function(e){return a.setLastDate(e)},label:"Tanggal Akhir",placeholder:"Masukan Tanggal Akhir"})),o.n.createElement("div",{className:"col-lg-4"},o.n.createElement("div",{className:"text-right"},o.n.createElement("label",null,"\xa0"),o.n.createElement("button",{type:"submit",value:"PDF",name:"type_btn",className:"btn btn-primary btn-block"},this.props.isLoading?o.n.createElement(o.n.Fragment,null,o.n.createElement("i",{className:"fas fa-spinner fa-spin"})," \xa0 Sedang Mencari"):"Cari Pesanan")))),this.props.isLoading?o.n.createElement(u.a,{loading:!0,background:"rgba(0, 0, 0, 0.35)",loaderColor:"rgba(94, 147, 117, 1)"}):null))}}]),t}(o.n.Component);b=Object(o.Q)({form:"HeadPesanan",enableReinitialize:!0})(b);var p=Object(o.u)(function(a){return{initialValues:{tgl_awal:Object(o.F)(),tgl_akhir:Object(o.F)()}}})(b),d=t(686),h=t(9),g=Object(o.w)({prefix:"Rp. ",locale:"kr-KO"}),_=[{value:"CASH",name:"CASH"},{value:"DEBET",name:"DEBET"},{value:"TRANSFER",name:"TRANSFER"},{value:"CREDIT",name:"CREDIT"}],f=function(a){Object(i.a)(t,a);var e=Object(s.a)(t);function t(a){var r;return Object(n.a)(this,t),(r=e.call(this,a)).state={isLoading:!1,type_pembayaran:"CASH",columns:[{dataField:"type",text:"Type",footerAttrs:{colSpan:"1"},footer:"Grand Total"},{dataField:"Total",text:"Total",footer:""}]},r}return Object(r.a)(t,[{key:"componentDidMount",value:function(){var a=this;this.props.dispatch(Object(h.Wb)());var e=JSON.parse(Object(o.J)("data_barang_ambil_pesanan"));setTimeout(function(){var e=JSON.parse(localStorage.getItem("trx_pemabayran_ambil_pesanan"))||[],t=0;e.forEach(function(a){t=a.nominal+t});var n=Object(o.j)(document.getElementById("grand_total_pembayaran").value);a.props.change("harus_bayar_rp",parseInt(n)-parseInt(t))},100),this.props.change("grand_total_pembayaran",e.total_harga),this.props.change("jenis","CASH"),setTimeout(function(){document.getElementById("cash_trx_penjualan").focus()},100)}},{key:"hitungTotal",value:function(){this.props.change("kembali",this.props.kembali),this.props.change("nominal_kembali",this.props.nominal_kembali)}},{key:"pilihPembyaran",value:function(a){"CASH"===a?this.setState({type_pembayaran:"CASH"}):"TRANSFER"===a?this.setState({type_pembayaran:"TRANSFER"}):"DEBET"===a?this.setState({type_pembayaran:"DEBET"}):this.setState({type_pembayaran:"CREDIT"}),this.props.change("cash","")}},{key:"render",value:function(){var a=this;return o.n.createElement("form",{onSubmit:this.props.handleSubmit,onKeyPress:function(a){"Enter"===a.key&&a.preventDefault()},autoComplete:"off"},o.n.createElement("div",{className:"row"},o.n.createElement("div",{className:"col-6"},o.n.createElement(o.c,Object.assign({id:"grand_total_pembayaran",name:"grand_total_pembayaran",component:o.p,type:"text",onChange:this.hitungTotal(),readOnly:!0},g,{label:"Total Harga Jual",placeholder:"Total Harga Jual"}))),o.n.createElement("div",{className:"col-6"},o.n.createElement(o.c,Object.assign({id:"harus_bayar_rp",name:"harus_bayar_rp",component:o.p,type:"text",onChange:this.hitungTotal(),readOnly:!0},g,{label:"Harus Bayar Rp",placeholder:"Harus Bayar Rp"}))),o.n.createElement("div",{className:"col-6"},o.n.createElement(o.c,{name:"jenis",label:"Pilih Jenis Bayar",placeholder:"Pilih Jenis Pembayaran",options:_,onChange:function(e){return a.pilihPembyaran(e)},component:o.q})),o.n.createElement("div",{className:"col-6",style:{display:"CASH"===this.state.type_pembayaran?"none":(this.state.type_pembayaran,"block")}},o.n.createElement(o.c,{tabIndex:"1",name:"nama_bank",id:"nama_bank",component:o.p,type:"text",label:"Bank",placeholder:"Masukan Nama Bank"})),o.n.createElement("div",{className:"col-6",style:{display:"CASH"===this.state.type_pembayaran?"none":"DEBET"===this.state.type_pembayaran?"none":"block"}},o.n.createElement(o.c,{tabIndex:"1",name:"no_card",id:"no_card",component:o.p,type:"text",label:"Card No",placeholder:"Masukan Card No"})),o.n.createElement("div",{className:"col-6"},o.n.createElement(o.c,Object.assign({tabIndex:"1",name:"cash",id:"cash_trx_penjualan",component:o.p,type:"text",label:"Nominal",onChange:this.hitungTotal()},g,{normalize:o.j,placeholder:"Masukan Nominal"}))),o.n.createElement("div",{className:"col-6",style:{display:"CREDIT"===this.state.type_pembayaran?"block":"none"}},o.n.createElement(o.c,{tabIndex:"1",name:"fee",id:"fee",component:o.p,type:"text",label:"Fee (%)",normalize:o.j,placeholder:"5"})),o.n.createElement("div",{className:"col-6 d-none"},o.n.createElement(o.c,{tabIndex:"1",name:"nominal_kembali",component:o.p,type:"text",label:"Nominal",placeholder:"Masukan Nominal"})),o.n.createElement("div",{className:"col-6"},o.n.createElement(o.c,{name:"kembali",id:"sisa_bayar",component:o.p,type:"text",readOnly:!0,label:"Sisa",normalize:o.j,placeholder:"Sisa Pembayaran"})),o.n.createElement("div",{className:"CASH"===this.state.type_pembayaran?"col-6 text-right":"TRANSFER"===this.state.type_pembayaran?"col-6 text-right":"col-12 text-right"},o.n.createElement("br",null),o.n.createElement("label",null,"\xa0"),o.n.createElement("button",{tabIndex:"2",className:"btn btn-primary"}," ",o.n.createElement("i",{className:"fa fa-plus"})))))}}]),t}(o.b);f=Object(o.Q)({form:"HeadInputPembayaran",enableReinitialize:!0,validate:d.a})(f);var E=Object(o.y)("HeadInputPembayaran"),y=Object(o.u)(function(a){var e=E(a,"grand_total_pembayaran","cash"),t=e.cash,n=e.grand_total_pembayaran,r=JSON.parse(localStorage.getItem("trx_pemabayran_ambil_pesanan"))||[],l=0;r.forEach(function(a){l=a.nominal+l});var i=parseFloat(l||0)-parseFloat(n||0);return{harus_bayar_rp:i,kembali:i.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),nominal_cash:t,nominal_kembali:i+parseInt(t)}})(f),k=function(a){Object(i.a)(t,a);var e=Object(s.a)(t);function t(a){var r;return Object(n.a)(this,t),(r=e.call(this,a)).state={isLoading:!1,type_pembayaran:"CASH",kembalian:"",columns:[{dataField:"jenis",text:"Jenis",footerAttrs:{colSpan:"2"},footer:"Grand Total"},{dataField:"keterangan",text:"Keterangan"},{dataField:"nominal",text:"Total",formatter:function(a){return o.n.createElement("span",null,parseInt(a).toLocaleString("kr-KO"))},footer:function(a){return parseInt(a.reduce(function(a,e){return a+e},0)).toLocaleString("kr-KO")}},{dataField:"action",text:"Action",csvExport:!1,headerClasses:"text-center",formatter:function(a,e,t){return o.n.createElement("div",{className:"row text-center"},o.n.createElement("div",{className:"col-12"},o.n.createElement("button",{type:"button",disabled:"DONE"===e.status,onClick:function(){return r.hapusdata(t)},className:"btn btn-danger mr-3"},o.n.createElement("i",{className:"fa fa-trash"}))))},footer:""}]},r}return Object(r.a)(t,[{key:"hapusdata",value:function(a){var e=this;o.r.fire({title:"Anda Yakin !!",text:"Ingin Menghapus Data Ini ?",icon:"warning",position:"top-center",cancelButtonText:"Tidak",showCancelButton:!0,confirmButtonText:"OK",showConfirmButton:!0}).then(function(t){if(t.isConfirmed){var n=Object(o.E)("trx_pemabayran_ambil_pesanan");n.splice(a,1),Object(o.S)("trx_pemabayran_ambil_pesanan",n),e.setState({status:"berhasil"})}})}},{key:"simpanPembayaran",value:function(a){if(void 0===a.no_card&&"CASH"!==a.jenis&&"DEBET"!==a.jenis)return Object(o.t)("info","Nomor kartu tidak boleh kosong"),!1;var e={total_transaksi:a.grand_total_pembayaran,sisa_bayar:a.nominal_kembali};if(void 0===a.nama_bank&&"CASH"!==a.jenis)return Object(o.t)("info","Nama Bank tidak boleh kosong"),!1;if(void 0===a.cash||"0"===a.cash)return Object(o.t)("info","Nominal tidak boleh kosong"),!1;Object(o.S)("sisa_bayar_pesanan",e);var t=JSON.parse(localStorage.getItem("trx_pemabayran_ambil_pesanan"))||[];if("CASH"===a.jenis||t.length){if("CASH"!==a.jenis){if(a.kembali.replace(/[^0-9]/g,"")-a.cash<0&&0!==parseInt(a.kembali))return Object(o.t)("info","Pembayaran tidak boleh lebih dari sisa"),!1;if(console.log(a.grand_total_pembayaran),t.reduce(function(a,e){return a+e.nominal},0)>=a.grand_total_pembayaran)return Object(o.t)("info","Pembayaran Sudah Cukup1"),!1}}else if(a.kembali.replace(/[^0-9]/g,"")-a.cash<0)return Object(o.t)("info","Pembayaran tidak boleh lebih dari sisa"),!1;if(t.findIndex(function(a){return"CASH"===a.jenis})>=0){if(a.kembali.replace(/[^0-9]/g,"")-a.cash<0&&t.reduce(function(a,e){return a+e.nominal},0)>a.grand_total_pembayaran)return Object(o.t)("info","Pembayaran Sudah Cukup2"),!1;if(t.reduce(function(a,e){return a+e.nominal},0)>=a.grand_total_pembayaran)return Object(o.t)("info","Pembayaran Sudah Cukup3"),!1}if(-1===t.findIndex(function(e){return e.jenis===a.jenis})){var n="";n="CASH"===a.jenis?"CASH":"TRANSFER"===a.jenis?a.no_card+" - "+a.nama_bank:a.nama_bank;var r={jenis:a.jenis,nominal:parseInt(a.cash)*parseInt(a.fee||0)/100+parseInt(a.cash),nama_bank:a.nama_bank,fee:"CREDIT"===a.jenis&&a.fee||0,no_card:a.no_card||"-",keterangan:n,kembali:a.nominal_kembali};t.push(r),this.setState({masuk:!0,kembalian:a.kembali}),Object(o.S)("trx_pemabayran_ambil_pesanan",t)}else{var l=Object(o.E)("trx_pemabayran_ambil_pesanan");l=l.map(function(e){return e.jenis===a.jenis&&(e.nominal+=parseInt(a.cash)),e}),Object(o.S)("trx_pemabayran_ambil_pesanan",l),this.setState({status:!0,kembalian:a.kembalian})}}},{key:"render",value:function(){var a=this;return o.n.createElement(o.n.Fragment,null,o.n.createElement(y,{onSubmit:function(e){return a.simpanPembayaran(e)}}),o.n.createElement("hr",null),o.n.createElement("form",{onSubmit:this.props.handleSubmit,onKeyPress:function(a){"Enter"===a.key&&a.preventDefault()},autoComplete:"off"},o.n.createElement(o.s,{keyField:"jenis",exportCsv:!1,data:Object(o.E)("trx_pemabayran_ambil_pesanan")||[],columns:this.state.columns,empty:!0,pagination:"off",textEmpty:"Data Pembayaran Kosong"}),o.n.createElement("div",{className:"row"},o.n.createElement("div",{className:"col-12 text-right"},o.n.createElement("button",{className:"btn btn-primary",disabled:this.props.isLoadingPembayran,onClick:function(){return a.props.simpanPembayaran()},type:"button"},this.props.isLoadingPembayran?o.n.createElement(o.n.Fragment,null,o.n.createElement("i",{className:"fas fa-spinner fa-spin"})," \xa0 Sedang Diproses"):"Bayar Sekarang")))))}}]),t}(o.b);k=Object(o.Q)({form:"ModalPembayaran",enableReinitialize:!0,validate:d.a})(k);var j=Object(o.u)(function(a){var e=Object(o.E)("data_barang_pesanan")||[],t="PENJUALAN";return e.forEach(function(a){"-"===a.no_titip_group&&(t="PENJUALAN"),t="-"===a.no_pesanan?"PESANAN":"TITIPAN"}),{status:t}})(k),v=function(a){Object(i.a)(t,a);var e=Object(s.a)(t);function t(a){var r;return Object(n.a)(this,t),(r=e.call(this,a)).state={isLoading:!1,datapesanan:[],columns:[{dataField:"no_pesanan",text:"No Pesanan",footerAttrs:{colSpan:"3"},footer:"Total"},{dataField:"tanggal_transaksi",text:"Tgl Transaksi"},{dataField:"nama_customer",text:"Nama Customer"},{dataField:"no_hp",text:"Nomor HP"},{dataField:"total_harga",text:"Total Harga",formatter:function(a){return o.n.createElement("span",null,parseInt(a).toLocaleString("kr-KO"))}},{dataField:"jumlah_bayar",text:"Jumlah Pembayaran",formatter:function(a){return o.n.createElement("span",null,parseInt(a).toLocaleString("kr-KO"))}},{dataField:"action",text:"Action",csvExport:!1,headerClasses:"text-center",formatter:function(a,e,t){return o.n.createElement("div",{className:"row text-center"},o.n.createElement("div",{className:"col-12"},o.n.createElement("button",{type:"button",disabled:"DONE"===e.status_pesanan,"data-tooltip":"DONE"===e.status_pesanan?"Tidak Bisa Dibatal":"Batal Pesanan",onClick:function(){return r.batalPesanan(e)},className:"btn btn-danger mr-3"},o.n.createElement("i",{className:"fa fa-window-close"}))))},footer:""}]},r.handleSubmit=r.handleSubmit.bind(Object(l.a)(r)),r}return Object(r.a)(t,[{key:"ambilpesanan",value:function(a){var e=this,t=[];a.pembayaran.forEach(function(a){var e={jenis:a.jenis,keterangan:a.keterangan,nominal:a.jumlah_rp,status:"DONE"};t.push(e)}),Object(o.S)("trx_pemabayran_ambil_pesanan",t),Object(c.k)("pesanan/ambil/no",{no_pesanan:a.no_pesanan}).then(function(a){Object(o.S)("data_barang_ambil_pesanan",a.data),e.props.dispatch(Object(o.T)())}).catch(function(a){Object(o.t)("info","Terjadi Kesalahaan Saat Request Data")})}},{key:"batalPesanan",value:function(a){var e=this;o.r.fire({title:"Anda Yakin !!",text:"Ingin Membatalkan Pesanan Ini ?",icon:"warning",position:"top-center",cancelButtonText:"Tidak",showCancelButton:!0,confirmButtonText:"OK",showConfirmButton:!0}).then(function(t){if(t.isConfirmed){var n=Object(o.E)("tgl_laporan");e.setState({isLoading:!0}),Object(c.q)("pesanan/cancel",{no_pesanan:a.no_pesanan}).then(function(a){e.setState({isLoading:!1}),Object(o.t)("success","Pesanan Berhasil Di Batal"),Object(c.e)("pesanan/"+n.tgl_awal+"/"+n.tgl_akhir).then(function(a){var t=[];a.data.forEach(function(a){var e={no_pesanan:a.no_pesanan,nama_customer:a.nama_customer,no_hp:a.no_hp,sisa_bayar:a.sisa_bayar,jumlah_bayar:a.jumlah_bayar,total_harga:a.total_harga,tanggal_transaksi:a.tanggal,detail_barang:a.detail_barang,pembayaran:a.pembayaran,status_pesanan:a.status_pesanan};t.push(e)}),e.setState({datapesanan:t,isLoading:!1})})}).catch(function(a){e.setState({isLoading:!1}),Object(o.t)("info",/conflict/i.test(a.response.data.message||"Error")?"Terjadi Kesalahan Saat Mengirim Data":a.response.data.message)})}})}},{key:"handleSubmit",value:function(a){var e=this;this.setState({isLoading:!0}),Object(c.e)("pesanan/"+a.tgl_awal+"/"+a.tgl_akhir).then(function(t){0===t.data.length&&Object(o.t)("info","Data Pesanan Tidak Ada");var n=[];t.data.forEach(function(a){var e={no_pesanan:a.no_pesanan,nama_customer:a.nama_customer,no_hp:a.no_hp,sisa_bayar:a.sisa_bayar,jumlah_bayar:a.jumlah_bayar,total_harga:a.total_harga,tanggal_transaksi:a.tanggal,detail_barang:a.detail_barang,pembayaran:a.pembayaran,status_pesanan:a.status_pesanan};n.push(e)});var r={tgl_awal:Object(o.z)(Object(o.L)(new Date(a.tgl_awal)).format("YYYY-MM-DD")),tgl_akhir:Object(o.z)(Object(o.L)(new Date(a.tgl_akhir)).format("YYYY-MM-DD"))};e.setState({isLoading:!1,datapesanan:n}),Object(o.S)("tgl_laporan",r)}).catch(function(a){Object(o.t)("info",/conflict/i.test(a.response.data.message||"Error")?"Terjadi Kesalahan Saat Mengirim Data":a.response.data.message),e.setState({isLoading:!1})})}},{key:"render",value:function(){var a=this,e={renderer:function(a){return o.n.createElement("div",{className:"container"},o.n.createElement("div",{className:"row"},o.n.createElement("div",{className:"col-12"},"Detail Barang",o.n.createElement("table",null,o.n.createElement("tr",null,o.n.createElement("td",null," Kode Kategori "),o.n.createElement("td",null," Perkiraan Berat "),o.n.createElement("td",null," Perkiraan Kadar "),o.n.createElement("td",null," Harga / Gram "),o.n.createElement("td",null," Attribut "),o.n.createElement("td",null," Harga Attribut "),o.n.createElement("td",null," Kode Barcode "),o.n.createElement("td",null," Ongkos "),o.n.createElement("td",null," Total "),o.n.createElement("td",null," keterangan "),o.n.createElement("td",null," Deskripsi "),o.n.createElement("td",null," Deskripsi Contoh ")),a.detail_barang.map(function(a,e){return o.n.createElement(o.n.Fragment,null,o.n.createElement("tr",null,o.n.createElement("td",null," ",a.kode_kategori),o.n.createElement("td",null," ",a.perkiraan_berat.toFixed(3)),o.n.createElement("td",null," ",a.perkiraan_kadar),o.n.createElement("td",null," ",a.harga_gram.toLocaleString("kr-KO")),o.n.createElement("td",null," ",a.attribut),o.n.createElement("td",null," ",a.harga_atribut.toLocaleString("kr-KO")),o.n.createElement("td",null," ",a.kode_barcode),o.n.createElement("td",null," ",a.ongkos.toLocaleString("kr-KO")),o.n.createElement("td",null," ",a.sub_total.toLocaleString("kr-KO")),o.n.createElement("td",null," ",a.keterangan),o.n.createElement("td",null," ",a.deskripsi),o.n.createElement("td",null," ",a.deskripsi_contoh)))})))))},showExpandColumn:!0};return o.n.createElement("div",null,o.n.createElement("ol",{className:"breadcrumb float-xl-right"},o.n.createElement("li",{className:"breadcrumb-item"},o.n.createElement(o.g,{to:"#"},"Pesanan")),o.n.createElement("li",{className:"breadcrumb-item active"},"Lihat Pesanan")),o.n.createElement("h1",{className:"page-header"},"Lihat Pesanan "),o.n.createElement(o.k,null,o.n.createElement(o.m,null,"Lihat Pesanan"),o.n.createElement("br",null),o.n.createElement("div",{className:"container"},o.n.createElement(p,{isLoading:this.state.isLoading,onSubmit:function(e){return a.handleSubmit(e)}}),o.n.createElement(o.s,{keyField:"no_pesanan",exportCsv:!1,data:this.state.datapesanan,columns:this.state.columns,empty:!0,textEmpty:"Data Barang Kosong",expandRow:e})),o.n.createElement("br",null),o.n.createElement(o.i,{size:"l",title:"Form Pembayaran",content:o.n.createElement(j,{isLoadingPembayranTitipan:this.state.isLoadingPembayranTitipan,isLoadingPembayran:this.state.isLoadingPembayran,bayarTitipan:function(e){return a.bayarTitipan(e)},simpanPembayaran:function(e){return a.simpanPembayaranAmbilPesanan(e)}})})),this.state.isLoading?o.n.createElement(u.a,{loading:!0,background:"rgba(0, 0, 0, 0.35)",loaderColor:"rgba(94, 147, 117, 1)"}):null)}}]),t}(o.n.Component);v=Object(o.Q)({form:"LihatPesanan",enableReinitialize:!0})(v);e.default=Object(o.u)()(v)},686:function(a,e,t){"use strict";e.a=function(a){var e={};return a.jenis||(e.jenis="Jenis Tidak Boleh Kosong"),e}}}]);
//# sourceMappingURL=58.4ec6c70f.chunk.js.map